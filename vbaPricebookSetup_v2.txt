
'' VBA Pricebook Scripts v2


Sub notes()
  ' subs completed & tested:
  '    subName
  ' functions complteted & tested:
  '    getItemPrefix()
  '    getItemSuffix()

End Sub

Sub boneyard()
  ' scraps go here
  
  ' while loop
  'Dim count As Integer
  'count = 0
  'Do While itemPrefix
  '  count = count + 1

    '' TEST
   ' If count = 100 Then
    '    MsgBox ("exiting Do While based on count")
     '   Exit Do
    'End If
  'Loop
    
  
End Sub

Function getItemPrefix(r, c, flag) As String
  ' declare local variables
  Dim trimVal As Integer
  Dim itemPrefix As String
  Set dataPtr = Worksheets("data").Cells(r, c)
  
  ' 0 - return "start" if flag is True
  If flag = True Then
    getItemPrefix = "start"
    Exit Function
  End If

  ' 1 - return na to caller if the item field is na
  If dataPtr.Value = "na" Then
    getItemPrefix = "na"
    Exit Function
  End If
  
  ' 2 - return empty to caller if the item field is null
  If dataPtr.Value = "" Then
    getItemPrefix = "empty"
    Exit Function
  End If
  
  ' 3 - return error to caller if the item field has no hyphen
  Dim s As Boolean
  s = InStr(1, dataPtr, "-", 1)
  If s = 0 Then
    getItemPrefix = "error"
    Exit Function
  End If
  
  ' 4 - return the left side of the item field
  trimVal = InStr(1, dataPtr, "-")                ' get loc of hyphen in Item
  itemPrefix = Left(dataPtr.Value, trimVal - 1)   ' get left side of Item
  getItemPrefix = itemPrefix                      ' return the prefix
  
End Function



'' POPULATE THE TEMPLATE WITH DATA FROM THE PRICEBOOK
Sub populateTemplate()
  ' declare variables ------------------------------------
  
  ' initialize vars for row and col on template tab
  Dim tRow, tCol, dRow, dCol As Integer
  tRow = 8
  tCol = 1
  dRow = 2
  dCol = 1
  
  '===========================================
  ' get itemPrefix
  ' get category
  
  ' while Item != "" <-- outer loop
  '   initialize headers:
  '      if nuItemPrefix != itemPrefix
  '      if Sub-Category != "" then displaySubCategory
  '      else {displayCategory and if not first run (ie, dRow > 2), displayFieldNames}
  '   copy and paste records from data to template:
  '      while nuItemPrefix == itemPrefix then cnpRecord <-- inner loop
  '===========================================
  
  ' set start flag to indicate first run
  Dim startFlag As Boolean
  startFlag = True

  ' get itemPrefix
  itemPrefix = getItemPrefix(dRow, dCol, startFlag)
  startFlag = False
  
  ' declare currItemPrefix
  ' will be used to evaluate conditions against itemPrefix
  Dim currItemPrefix As String
  
  ' get category -- To Do
  ' code goes here
  
  ' TEST create counter to control loop
  Dim count As Integer
  count = 0
  ' end test
  
  ' outer loop: do while itemPrefix is not null
  Do While itemPrefix <> "empty" Or count < 100
    
    ' TEST
    count = count + 1
    If count = 3 Then
      itemPrefix = ""
      Exit Do
    End If
    ' end test
    
    currItemPrefix = getItemPrefix(dRow, dCol, startFlag)
    
    '
    '   If currItemPrefix <> itemPrefix And currCategory <> category Then
    '       insert category header and promote tRow
    '       insert field-name row and promote tRow
    '     End If
    '
    '     If currItemPrefix <> itemPrefix And subCategory <> "" Then
    '       insert subCat header and promote tRow
    '     End If
    '
    '
    '   Do While currItemPrefix = itemPrefix
    '     Insert HEADERS
    '
    '     INSERT RECORDS
    '
    '       '   copy rows from data tab to template tab for each itemPrefix
    '
    '   if currItemPrefix = itemPrefix Then copy and paste row from data tab to template tab
    '   promote tRow, dRow
    '
    '
    ' TEST
         countStr = CStr(count)
         MsgBox (currItemPrefix + " | " + itemPrefix + " | " + countStr) ' TEST
    ' End Test
    '
    
    itemPrefix = currItemPrefix
  
  Loop

  ' message success and end sub
    '
    ' TEST
         MsgBox (currItemPrefix + " | " + itemPrefix + " | " + countStr) ' TEST
    ' End Test
    '

End Sub
  

